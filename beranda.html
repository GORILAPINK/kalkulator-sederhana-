<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ’– Aplikasi Keuangan Pink Cantik ğŸ’–</title>

<!-- Library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<!-- Style -->
<style>
@import url('https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@400;600&display=swap');

body {font-family:'Poppins',sans-serif;background:#ffe6f2;margin:0;padding:0;text-align:center;color:#333;}
h1 {font-family:'Pacifico',cursive;color:#e75480;font-size:1.8em;margin:15px 0;}
.container {max-width:400px;margin:auto;background:#fff;border-radius:20px;padding:15px;box-shadow:0 5px 15px rgba(231,84,128,0.3);}

form {display:flex;flex-wrap:wrap;justify-content:center;gap:5px;margin-bottom:15px;}
input {padding:6px 10px;border-radius:10px;border:1px solid #e75480;font-size:14px;min-width:120px;}
button {padding:6px 12px;border-radius:10px;border:none;background:linear-gradient(45deg,#ff69b4,#e75480);color:#fff;font-weight:bold;cursor:pointer;transition:.3s;font-size:13px;}
button:hover {transform:scale(1.05);background:linear-gradient(45deg,#e75480,#ff69b4);}

/* Ringkasan */
.summary {display:flex;justify-content:space-around;flex-wrap:wrap;gap:5px;margin-bottom:15px;}
.summary-box {flex:1;min-width:150px;background:#ffe4e1;color:#e75480;border-radius:12px;padding:8px;font-size:13px;font-weight:bold;box-shadow:0 3px 7px rgba(231,84,128,0.4);}

/* Grafik & Tabel */
.section-container {display:flex;gap:10px;flex-direction:column;margin-bottom:15px;}
.section-box {flex:1;background:#fff0f7;border-radius:12px;padding:10px;box-shadow:0 3px 7px rgba(231,84,128,0.2);}
.table-wrapper {width:100%;overflow-x:auto;}
table {width:100%;border-collapse:collapse;margin-top:5px;font-size:12px;}
th,td {padding:5px;text-align:center;}
th {background:#ff69b4;color:#fff;}
tr:nth-child(even){background:#ffe6f2;}

canvas {width:100%!important;height:150px!important;margin-top:5px;}

/* Tombol bawah */
.btn-group {margin-top:10px;display:flex;flex-wrap:wrap;justify-content:center;gap:5px;}
.btn-group button {background:#ffb6c1;color:#fff;font-size:12px;padding:5px 10px;}
.btn-group button.shareimage {background:#8b0000;}

/* Tombol Aksi di tabel */
.tabel-btn {padding:4px 8px;border:none;border-radius:15px;margin:1px;font-size:11px;cursor:pointer;font-weight:bold;transition:0.3s;}
.tabel-btn.edit {background:#ff69b4;color:#fff;}
.tabel-btn.hapus {background:#ffb6c1;color:#fff;}
.tabel-btn.edit:hover,.tabel-btn.hapus:hover {background:#e75480;}

footer {background:#ff69b4;color:#fff;padding:10px;font-family:'Pacifico',cursive;font-size:14px;margin-top:20px;border-radius:15px 15px 0 0;}

/* Tombol Kuisioner */
.kuisioner-btn {margin-top:10px;padding:8px 15px;border-radius:10px;border:none;background:linear-gradient(45deg,#ff69b4,#e75480);color:#fff;font-weight:bold;cursor:pointer;transition:.3s;font-size:14px;}

/* Responsive super compact */
@media(max-width:400px){
  h1 {font-size:1.5em;}
  input,button,.kuisioner-btn {width:90%;font-size:12px;padding:5px 10px;}
  .summary-box {font-size:12px;padding:6px;}
  table,th,td {font-size:10px;padding:4px;min-width:100%;}
  canvas {height:120px!important;}
  .btn-group button {font-size:11px;padding:4px 8px;}
  .tabel-btn {font-size:9px;padding:3px 6px;}
}
</style>
</head>

<body>
<div class="container" id="mainContainer">
  <h1>ğŸ’– Sweet Wallet ğŸ’–</h1>

  <!-- Form Input -->
  <form id="form">
    <input type="text" id="nama" placeholder="Nama Transaksi" required>
    <input type="number" id="jumlah" placeholder="Jumlah (Rp)" required>
    <button type="button" onclick="tambah('pemasukan')">+ Pemasukan</button>
    <button type="button" onclick="tambah('pengeluaran')">- Pengeluaran</button>
  </form>

  <!-- Ringkasan -->
  <div class="summary">
    <div class="summary-box">ğŸ’µ Pemasukan: <span id="totalPemasukan">Rp 0</span></div>
    <div class="summary-box">ğŸ’¸ Pengeluaran: <span id="totalPengeluaran">Rp 0</span></div>
    <div class="summary-box">ğŸ’° Sisa: <span id="uangSisa">Rp 0</span></div>
    <div class="summary-box">ğŸ¦ Tabungan Premium <br><button onclick="window.location.href='tabungan.html'">Rencana ğŸ’–</button></div>
  </div>

  <!-- Grafik & Tabel -->
  <div class="section-container">
    <div class="section-box">
      <div id="catatan" style="font-weight:600;color:#e75480;margin-bottom:5px;"></div>
      <canvas id="grafik"></canvas>
    </div>
    <div class="section-box">
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>No</th><th>Nama</th><th>Jumlah</th><th>Tipe</th><th>Aksi</th>
            </tr>
          </thead>
          <tbody id="tabel-body"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Tombol Kuisioner -->
  <button class="kuisioner-btn" onclick="window.open('https://link-kuisioner-anda.com','_blank')">ğŸ’– Kasih Rating ğŸ’–</button>

  <!-- Tombol Ekspor -->
  <div class="btn-group">
    <button onclick="downloadPDF()">ğŸ“„ PDF</button>
    <button onclick="downloadExcel()">ğŸ“Š Excel</button>
    <button class="shareimage" onclick="copyLink()">ğŸ”— Copy Link</button>
    <button class="shareimage" onclick="saveAsImage()">ğŸ–¼ï¸ Simpan Gambar</button>
  </div>

  <!-- Tombol keluar -->
  <div style="margin-top:10px;">
    <button type="button" onclick="window.location.href='index.html'">ğŸšª Keluar</button>
  </div>
</div>

<footer>ğŸ’– Aplikasi Keuangan Pink Cantik - Laporan lebih manis ğŸ’–</footer>

<script>
let data=[];
const ctx=document.getElementById('grafik').getContext('2d');
let chart=new Chart(ctx,{
  type:'line',
  data:{labels:[],datasets:[{label:'Saldo Berjalan',data:[],borderColor:"#e75480",fill:false}]},
  options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:"#e75480"}}}}
});

function formatRupiah(angka){return "Rp "+angka.toLocaleString("id-ID");}

function tambah(tipe){
  const nama=document.getElementById('nama').value.trim();
  const jumlah=parseInt(document.getElementById('jumlah').value);
  if(!nama||isNaN(jumlah)){alert("Isi nama dan jumlah dulu ya ğŸ’–");return;}
  data.push({nama,jumlah,tipe});
  document.getElementById('form').reset();
  update();
}

function update(){
  const body=document.getElementById('tabel-body');body.innerHTML="";
  let saldo=0,pemasukan=0,pengeluaran=0;
  data.forEach((d,i)=>{
    if(d.tipe==="pemasukan") pemasukan+=d.jumlah; else pengeluaran+=d.jumlah;
    body.innerHTML+=`
      <tr>
        <td>${i+1}</td>
        <td class="nama">${d.nama}</td>
        <td class="jumlah">${formatRupiah(d.jumlah)}</td>
        <td class="tipe">${d.tipe}</td>
        <td>
          <button class="tabel-btn edit" onclick="editRow(this,${i})">Edit</button>
          <button class="tabel-btn hapus" onclick="hapusData(${i})">Hapus</button>
        </td>
      </tr>`;
  });
  const sisa=pemasukan-pengeluaran;
  document.getElementById('totalPemasukan').innerText=formatRupiah(pemasukan);
  document.getElementById('totalPengeluaran').innerText=formatRupiah(pengeluaran);
  document.getElementById('uangSisa').innerText=formatRupiah(sisa);

  chart.data.labels=data.map((_,i)=>`T${i+1}`);
  chart.data.datasets[0].data=data.map((d,i)=>data.slice(0,i+1).reduce((sum,v)=>sum+(v.tipe==="pemasukan"?v.jumlah:-v.jumlah),0));
  chart.update();

  document.getElementById('catatan').innerText=pemasukan>pengeluaran?"ğŸ’• Jangan lupa ditabung ğŸ’•":(pengeluaran>pemasukan?"ğŸ’” Lebih hemat ğŸ’”":"ğŸ’— Pertahankan ğŸ’—");
}

function editRow(btn,index){
  const row=btn.parentElement.parentElement;
  const namaCell=row.querySelector(".nama");
  const jumlahCell=row.querySelector(".jumlah");
  const tipeCell=row.querySelector(".tipe");

  if(btn.innerText==="Edit"){
    namaCell.contentEditable="true";
    jumlahCell.contentEditable="true";
    const currentTipe=tipeCell.innerText;
    tipeCell.innerHTML=`<select>
      <option value="pemasukan" ${currentTipe==="pemasukan"?"selected":""}>pemasukan</option>
      <option value="pengeluaran" ${currentTipe==="pengeluaran"?"selected":""}>pengeluaran</option>
    </select>`;
    btn.innerText="Simpan";btn.style.background="#32cd32";
  } else {
    const nama=namaCell.innerText.trim();
    const jumlah=parseInt(jumlahCell.innerText.replace(/[^0-9]/g,""));
    const tipe=tipeCell.querySelector("select").value;
    if(!nama||isNaN(jumlah)){alert("Isi data valid ğŸ’–");return;}
    data[index]={nama,jumlah,tipe};
    update();
    btn.innerText="Edit";btn.style.background="#ff69b4";
  }
}

function hapusData(i){data.splice(i,1);update();}

function downloadPDF(){
  const {jsPDF}=window.jspdf;const doc=new jsPDF();
  doc.setTextColor(231,84,128);doc.text("Laporan Keuangan ğŸ’–",10,10);
  let y=20;
  data.forEach((d,i)=>{doc.text(`${i+1}. ${d.nama} - ${formatRupiah(d.jumlah)} (${d.tipe})`,10,y);y+=7;});
  doc.save("laporan.pdf");
}

function downloadExcel(){
  let ws=XLSX.utils.json_to_sheet(data.map((d,i)=>{return {No:i+1,Nama:d.nama,Jumlah:formatRupiah(d.jumlah),Tipe:d.tipe};}));
  let wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,"Laporan");XLSX.writeFile(wb,"laporan.xlsx");
}

function copyLink(){navigator.clipboard.writeText(window.location.href).then(()=>alert("Link berhasil disalin ğŸ’–"));}
function saveAsImage(){html2canvas(document.getElementById('mainContainer')).then(c=>{const link=document.createElement('a');link.href=c.toDataURL("image/png");link.download="laporan.png";link.click();});}

update();
</script>
</body>
</html>
